% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/h5_readers.R
\name{read_h5ad}
\alias{read_h5ad}
\title{Read H5AD file and convert to sparse matrix}
\usage{
read_h5ad(
  file_path,
  layer = NULL,
  use_raw = FALSE,
  transpose = TRUE,
  return_metadata = FALSE,
  feature_format = "gene_name",
  verbose = FALSE
)
}
\arguments{
\item{file_path}{Character. Path to the H5AD file.}

\item{layer}{Character. The layer to extract from the H5AD file.
Default is NULL, which reads from X (the main expression matrix).
Common alternatives include "counts", "data", "scaled", etc.}

\item{use_raw}{Logical. If TRUE, reads from the raw.X slot instead of X.
Default is FALSE.}

\item{transpose}{Logical. If TRUE, transposes the matrix so genes are rows
and cells are columns (gedi format). Default is TRUE.}

\item{return_metadata}{Logical. If TRUE, returns a list with the expression
matrix, cell metadata (obs), and gene metadata (var). If FALSE, returns
only the expression matrix. Default is FALSE.}

\item{feature_format}{Character. Which feature identifier to use for gene names
when return_metadata = FALSE. Options: "gene_name" (default, uses var rownames)
or "gene_ids" (uses var$gene_ids column). Default is "gene_name".}

\item{verbose}{Logical. If TRUE, prints detailed progress messages. Default is FALSE.}
}
\value{
If return_metadata = FALSE, returns a sparse matrix (dgCMatrix) with
genes as rows and cells as columns. If return_metadata = TRUE, returns a
list with components:
\itemize{
\item X: sparse expression matrix (genes x cells)
\item obs: data.frame of cell metadata
\item var: data.frame of gene metadata
}
}
\description{
Reads an H5AD file (AnnData format) and extracts the expression matrix
as a sparse dgCMatrix suitable for use with gedi R6 object.
}
\details{
This function reads H5AD files, which are the standard format for AnnData
objects in Python. Compatible with gedi R6 class for seamless integration.
}
\examples{
\donttest{
# Read H5AD file with default settings (uses gene names from var rownames)
expr_matrix <- read_h5ad("data.h5ad")

# Use Ensembl IDs from var$gene_ids column
expr_matrix <- read_h5ad("data.h5ad", feature_format = "gene_ids")

# Use with gedi R6 object
library(gedi2)
expr_matrix <- read_h5ad("data.h5ad")
samples <- factor(rep(c("sample1", "sample2"), each = ncol(expr_matrix) / 2))
gedi_obj <- gedi$new(n_sample = 2)
gedi_obj$setup(Y = expr_matrix, sample_id = samples, K = 10)
}

}
